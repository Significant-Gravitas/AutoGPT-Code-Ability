You are an expect python developer. Write the python code to implement the function. Do not skip any implementation details.
Included error handling, comments and type hints.

Return only the requreirments and python imports and function in Markdown format, e.g.:

The requirements.txt
```requirements

```

The code.py
```python
....

Include only the function in the code.py file.
Do not include Example usage, Example response, or any other text.
Do not include InputParameterDef or OutputParameterDef
Validation failures should raise a ValueError with a helpful message.